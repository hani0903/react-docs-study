# 렌더링과 커밋

React에서 컴포넌트가 화면에 보여지기까지 내부적으로 여러 단계를 거칩니다.
이 과정을 이해하면, React가 어떻게 효율적으로 UI를 업데이트하는지 알 수 있습니다.

## 1단계: 렌더링 트리거

컴포넌트가 렌더링되는 주요 트리거는 두 가지입니다

1. **초기 렌더링**
    - 앱이 처음 시작될 때, 루트 컴포넌트를 화면에 그려야 하므로 초기 렌더링이 트리거됩니다.
2. **`state`변수의 업데이트**
    - 컴포넌트의 state가 변경되면, React는 해당 컴포넌트를 다시 렌더링합니다.

### 초기 렌더링

앱이 처음 시작하는 경우, `createRoot`와 `render` 메서드를 사용해 루트 컴포넌트를 렌더링합니다.

```js
import Image from './Image.js';
import { createRoot } from 'react-dom/client';

const root = createRoot(document.getElementById('root'));
root.render(<Image />);
```

-   이 과정을 통해 초기 렌더링합니다.

### State 업데이트 시 리렌더링

컴포넌트가 초기 렌더링된 이후에는 `setState`와 같은 상태 업데이트 함수를 통해 리렌더링이 트리거됩니다.

> 상태가 변경되면 React는 해당 컴포넌트를 **렌더링 대기열에 추가**하고, 이후 적절한 시점에 렌더링을 수행합니다

## 2단계: React 컴포넌트 렌더링

렌더링이 트리거되면, React는 컴포넌트를 호출해 화면에 무엇을 표시할지 결정합니다

> 렌더링 = React에서 컴포넌트를 호출하는 것!

-   **초기 렌더링:** 루트 컴포넌트부터 시작해, 모든 자식 컴포넌트를 재귀적으로 호출합니다.
-   **이후 렌더링:** state가 변경된 컴포넌트를 시작으로, 관련된 자식 컴포넌트까지 호출합니다.

이 과정에서 React는 JSX를 React Element 객체로 변환하고, 컴포넌트 트리를 따라 가상 DOM 트리를 만듭니다.
컴포넌트가 다른 컴포넌트를 반환하면, 더 이상 자식이 없을 때까지 이 과정이 반복됩니다.

## 3단계: React가 DOM에 변경사항을 커밋

컴포넌트 렌더링이 끝나면, React는 실제 DOM에 변경 사항을 반영합니다.

-   **초기 렌더링:** React는 `appendChild()` DOM API를 사용하여 모든 DOM 노드를 새로 생성해 화면에 추가합니다.
-   **리렌더링:** 이전 렌더링 결과와 현재의 가상 DOM 트리를 비교(diffing)하여, 변경된 부분만 실제 DOM에 반영합니다.

> **React는 렌더링 간에 차이가 있는 경우에만 DOM 노드를 변경하므로 최소한의 작업만으로 화면을 업데이트합니다.**

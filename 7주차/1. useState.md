# useState

Reactì—ì„œ **ì»´í¬ë„ŒíŠ¸ì— ìƒíƒœ(state)ë¥¼ ì¶”ê°€**í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê°€ì¥ ê¸°ë³¸ì ì´ê³  ì¤‘ìš”í•œ Hookì´ë‹¤. í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì—ì„œ ë™ì ì¸ ê°’ì„ ê´€ë¦¬í•˜ê³ , ê°’ì´ ë³€ê²½ë  ë•Œ ì»´í¬ë„ŒíŠ¸ë¥¼ ë‹¤ì‹œ ë Œë”ë§ì‹œí‚¨ë‹¤.

```jsx
import { useState } from 'react';

function Counter() {
    const [count, setCount] = useState(0);

    return (
        <div>
            <p>í˜„ì¬ ì¹´ìš´íŠ¸: {count}</p>
            <button onClick={() => setCount(count + 1)}>ì¦ê°€</button>
        </div>
    );
}
```

---

## ê¸°ë³¸ ì‚¬ìš©ë²•

### ì»´í¬ë„ŒíŠ¸ì— state ì¶”ê°€í•˜ê¸°

```jsx
import { useState } from 'react';

function MyComponent() {
    // êµ¬ë¬¸: const [ìƒíƒœë³€ìˆ˜, ì„¤ì •í•¨ìˆ˜] = useState(ì´ˆê¸°ê°’);
    const [age, setAge] = useState(28);
    const [name, setName] = useState('Taylor');
    const [todos, setTodos] = useState([]);

    return (
        <div>
            <p>
                ì´ë¦„: {name}, ë‚˜ì´: {age}
            </p>
            <button onClick={() => setAge(age + 1)}>ë‚˜ì´ ì¦ê°€</button>
        </div>
    );
}
```

### í˜¸ì¶œ ìœ„ì¹˜ ê·œì¹™

-   **ì»´í¬ë„ŒíŠ¸ì˜ ìµœìƒìœ„ ë ˆë²¨**ì—ì„œë§Œ í˜¸ì¶œ ê°€ëŠ¥
-   **ì»¤ìŠ¤í…€ Hook ë‚´ë¶€**ì—ì„œë„ í˜¸ì¶œ ê°€ëŠ¥
-   ì¡°ê±´ë¬¸, ë°˜ë³µë¬¸, ì¤‘ì²© í•¨ìˆ˜ ë‚´ë¶€ì—ì„œëŠ” í˜¸ì¶œ ë¶ˆê°€

```jsx
function MyComponent() {
    // âœ… ì˜¬ë°”ë¥¸ ìœ„ì¹˜
    const [count, setCount] = useState(0);

    if (count > 5) {
        // âŒ ì¡°ê±´ë¬¸ ë‚´ë¶€ì—ì„œ Hook í˜¸ì¶œ ë¶ˆê°€
        const [error, setError] = useState('');
    }

    return <div>{count}</div>;
}
```

---

## ë§¤ê°œë³€ìˆ˜ì™€ ë°˜í™˜ê°’

### ë§¤ê°œë³€ìˆ˜: ì´ˆê¸° ìƒíƒœê°’

```jsx
// 1. ì§ì ‘ ê°’ ì „ë‹¬
const [name, setName] = useState('ì´ˆê¸° ì´ë¦„');
const [count, setCount] = useState(0);
const [isVisible, setIsVisible] = useState(true);

// 2. ì´ˆê¸°í™” í•¨ìˆ˜ ì „ë‹¬ (ì§€ì—° ì´ˆê¸°í™”)
const [todos, setTodos] = useState(() => {
    const savedTodos = localStorage.getItem('todos');
    return savedTodos ? JSON.parse(savedTodos) : [];
});
```

**ì´ˆê¸°í™” í•¨ìˆ˜ì˜ íŠ¹ì§•:**

-   ì´ˆê¸° ë Œë”ë§ì—ì„œë§Œ ì‹¤í–‰ë¨
-   ìˆœìˆ˜ í•¨ìˆ˜ì—¬ì•¼ í•¨ (ê°™ì€ ì…ë ¥ì— í•­ìƒ ê°™ì€ ì¶œë ¥)
-   ì¸ìˆ˜ë¥¼ ë°›ì§€ ì•Šì•„ì•¼ í•¨
-   ê°’ì„ ë°˜ë“œì‹œ ë°˜í™˜í•´ì•¼ í•¨

### ë°˜í™˜ê°’: [ìƒíƒœ, ìƒíƒœ ì„¤ì • í•¨ìˆ˜]

```jsx
const [current, setCurrent] = useState(initial);
```

1. **current**: í˜„ì¬ ìƒíƒœê°’ (ì²« ë Œë”ë§ì—ì„œëŠ” ì´ˆê¸°ê°’ê³¼ ë™ì¼)
2. **setCurrent**: ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜

---

## ìƒíƒœ ì—…ë°ì´íŠ¸ ë°©ë²•

### 1. ì§ì ‘ ê°’ ì„¤ì •

```jsx
function Counter() {
    const [count, setCount] = useState(0);

    const handleIncrement = () => {
        setCount(count + 1); // í˜„ì¬ ê°’ + 1
    };

    return <button onClick={handleIncrement}>ì¹´ìš´íŠ¸: {count}</button>;
}
```

### 2. ì—…ë°ì´í„° í•¨ìˆ˜ ì‚¬ìš©

```jsx
function Counter() {
    const [count, setCount] = useState(0);

    const handleIncrement = () => {
        // ì´ì „ ìƒíƒœë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒˆ ìƒíƒœ ê³„ì‚°
        setCount((prevCount) => prevCount + 1);
    };

    // ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œí•  ë•Œ ìœ ìš©
    const handleIncrementThree = () => {
        setCount((prev) => prev + 1); // 1
        setCount((prev) => prev + 1); // 2
        setCount((prev) => prev + 1); // 3
    };

    return (
        <div>
            <button onClick={handleIncrement}>+1</button>
            <button onClick={handleIncrementThree}>+3</button>
            <p>ì¹´ìš´íŠ¸: {count}</p>
        </div>
    );
}
```

**ì–¸ì œ ì—…ë°ì´í„° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í• ê¹Œ?**

-   ì´ì „ ìƒíƒœì— ê¸°ë°˜í•´ì„œ ìƒˆ ìƒíƒœë¥¼ ê³„ì‚°í•  ë•Œ
-   ê°™ì€ ì´ë²¤íŠ¸ì—ì„œ ì—¬ëŸ¬ ë²ˆ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œ
-   ì½œë°± í•¨ìˆ˜ ë‚´ì—ì„œ ìµœì‹  ìƒíƒœë¥¼ ë³´ì¥í•˜ê³  ì‹¶ì„ ë•Œ

---

## ê°ì²´ì™€ ë°°ì—´ ìƒíƒœ ê´€ë¦¬

### ê°ì²´ ìƒíƒœ ì—…ë°ì´íŠ¸

```jsx
function UserProfile() {
    const [user, setUser] = useState({
        name: 'John',
        age: 25,
        email: 'john@example.com',
    });

    const updateName = (newName) => {
        // âŒ ì§ì ‘ ìˆ˜ì • (ë¶ˆë³€ì„± ìœ„ë°˜)
        user.name = newName;
        setUser(user);

        // âœ… ìƒˆ ê°ì²´ ìƒì„± (ë¶ˆë³€ì„± ìœ ì§€)
        setUser({
            ...user,
            name: newName,
        });

        // âœ… ì—…ë°ì´í„° í•¨ìˆ˜ ì‚¬ìš©
        setUser((prevUser) => ({
            ...prevUser,
            name: newName,
        }));
    };

    return (
        <div>
            <p>
                {user.name} ({user.age}ì„¸)
            </p>
            <button onClick={() => updateName('Jane')}>ì´ë¦„ ë³€ê²½</button>
        </div>
    );
}
```

### ë°°ì—´ ìƒíƒœ ì—…ë°ì´íŠ¸

```jsx
function TodoList() {
    const [todos, setTodos] = useState([]);

    const addTodo = (text) => {
        // âœ… ìƒˆ ë°°ì—´ ìƒì„±
        setTodos([...todos, { id: Date.now(), text, completed: false }]);
    };

    const removeTodo = (id) => {
        // âœ… í•„í„°ë§ìœ¼ë¡œ ìƒˆ ë°°ì—´ ìƒì„±
        setTodos(todos.filter((todo) => todo.id !== id));
    };

    const toggleTodo = (id) => {
        // âœ… mapìœ¼ë¡œ ìƒˆ ë°°ì—´ ìƒì„±
        setTodos(todos.map((todo) => (todo.id === id ? { ...todo, completed: !todo.completed } : todo)));
    };

    return (
        <div>
            {todos.map((todo) => (
                <div key={todo.id}>
                    <span
                        style={{
                            textDecoration: todo.completed ? 'line-through' : 'none',
                        }}
                    >
                        {todo.text}
                    </span>
                    <button onClick={() => toggleTodo(todo.id)}>ì™„ë£Œ</button>
                    <button onClick={() => removeTodo(todo.id)}>ì‚­ì œ</button>
                </div>
            ))}
            <button onClick={() => addTodo('ìƒˆ í• ì¼')}>í• ì¼ ì¶”ê°€</button>
        </div>
    );
}
```

---

## ì£¼ì˜ì‚¬í•­ê³¼ í”í•œ ì‹¤ìˆ˜

### 1. ìƒíƒœ ì—…ë°ì´íŠ¸ëŠ” ë¹„ë™ê¸°ì 

```jsx
function Counter() {
    const [count, setCount] = useState(0);

    const handleClick = () => {
        setCount(count + 1);
        console.log(count); // âŒ ì•„ì§ ì´ì „ ê°’! (0ì´ ì¶œë ¥ë¨)

        // âœ… ì—…ë°ì´íŠ¸ëœ ê°’ì„ ì¦‰ì‹œ ì‚¬ìš©í•˜ë ¤ë©´
        const newCount = count + 1;
        setCount(newCount);
        console.log(newCount); // âœ… ìƒˆ ê°’ (1ì´ ì¶œë ¥ë¨)
    };

    return <button onClick={handleClick}>ì¹´ìš´íŠ¸: {count}</button>;
}
```

### 2. ê°ì²´/ë°°ì—´ ì§ì ‘ ìˆ˜ì • ê¸ˆì§€

```jsx
function BadExample() {
    const [items, setItems] = useState(['apple', 'banana']);

    const addItem = () => {
        // âŒ ê¸°ì¡´ ë°°ì—´ì„ ì§ì ‘ ìˆ˜ì •
        items.push('orange');
        setItems(items); // Reactê°€ ì—…ë°ì´íŠ¸ë¥¼ ë¬´ì‹œí•¨. ë¦¬ë Œë”ë§ ë°œìƒ âŒ

        // âœ… ìƒˆ ë°°ì—´ ìƒì„±
        setItems([...items, 'orange']);
    };
}
```

### 3. ì¡°ê±´ë¶€ Hook í˜¸ì¶œ ê¸ˆì§€

```jsx
function ConditionalHooks({ condition }) {
    // âŒ ì¡°ê±´ë¶€ë¡œ Hook í˜¸ì¶œ
    if (condition) {
        const [state, setState] = useState(0);
    }

    // âœ… í•­ìƒ ê°™ì€ ìˆœì„œë¡œ Hook í˜¸ì¶œ
    const [state, setState] = useState(condition ? 0 : null);
}
```

-   ë¦¬ì•¡íŠ¸ëŠ” Hook í˜¸ì¶œ ìˆœì„œë¥¼ ê¸°ì–µí•¨

---

## ì‹¤ë¬´ í™œìš© íŒ¨í„´

### 1. í¼ ìƒíƒœ ê´€ë¦¬

```jsx
function ContactForm() {
    const [formData, setFormData] = useState({
        name: '',
        email: '',
        message: '',
    });

    const [errors, setErrors] = useState({});
    const [isSubmitting, setIsSubmitting] = useState(false);

    const handleChange = (e) => {
        const { name, value } = e.target;
        setFormData((prev) => ({
            ...prev,
            [name]: value,
        }));

        // ì—ëŸ¬ ìƒíƒœ ì´ˆê¸°í™”
        if (errors[name]) {
            setErrors((prev) => ({
                ...prev,
                [name]: '',
            }));
        }
    };

    const handleSubmit = async (e) => {
        e.preventDefault();
        setIsSubmitting(true);

        try {
            await submitForm(formData);
            setFormData({ name: '', email: '', message: '' });
        } catch (error) {
            setErrors({ submit: error.message });
        } finally {
            setIsSubmitting(false);
        }
    };

    return (
        <form onSubmit={handleSubmit}>
            <input name="name" value={formData.name} onChange={handleChange} placeholder="ì´ë¦„" />
            <input name="email" value={formData.email} onChange={handleChange} placeholder="ì´ë©”ì¼" />
            <textarea name="message" value={formData.message} onChange={handleChange} placeholder="ë©”ì‹œì§€" />
            <button type="submit" disabled={isSubmitting}>
                {isSubmitting ? 'ì „ì†¡ ì¤‘...' : 'ì „ì†¡'}
            </button>
        </form>
    );
}
```

### 2. ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ê´€ë¦¬

```jsx
function ShoppingCart() {
    const [cart, setCart] = useState([]);

    const addToCart = (product) => {
        setCart((prev) => {
            const existingItem = prev.find((item) => item.id === product.id);

            if (existingItem) {
                // ê¸°ì¡´ ì•„ì´í…œì˜ ìˆ˜ëŸ‰ ì¦ê°€
                return prev.map((item) => (item.id === product.id ? { ...item, quantity: item.quantity + 1 } : item));
            } else {
                // ìƒˆ ì•„ì´í…œ ì¶”ê°€
                return [...prev, { ...product, quantity: 1 }];
            }
        });
    };

    const removeFromCart = (productId) => {
        setCart((prev) => prev.filter((item) => item.id !== productId));
    };

    const updateQuantity = (productId, newQuantity) => {
        if (newQuantity <= 0) {
            removeFromCart(productId);
            return;
        }

        setCart((prev) => prev.map((item) => (item.id === productId ? { ...item, quantity: newQuantity } : item)));
    };

    const getTotalPrice = () => {
        return cart.reduce((total, item) => total + item.price * item.quantity, 0);
    };

    return (
        <div>
            <h2>ì¥ë°”êµ¬ë‹ˆ (ì´ {getTotalPrice()}ì›)</h2>
            {cart.map((item) => (
                <div key={item.id}>
                    <span>
                        {item.name} x {item.quantity}
                    </span>
                    <button onClick={() => updateQuantity(item.id, item.quantity + 1)}>+</button>
                    <button onClick={() => updateQuantity(item.id, item.quantity - 1)}>-</button>
                    <button onClick={() => removeFromCart(item.id)}>ì‚­ì œ</button>
                </div>
            ))}
        </div>
    );
}
```

### 3. ì»´í¬ë„ŒíŠ¸ ê°„ ìƒíƒœ ê³µìœ  (ìƒíƒœ í˜¸ì´ìŠ¤íŒ…)

```jsx
function App() {
    const [user, setUser] = useState(null);
    const [theme, setTheme] = useState('light');

    return (
        <div className={`app theme-${theme}`}>
            <Header user={user} theme={theme} onThemeChange={setTheme} />
            <Main user={user} />
            <Footer />
        </div>
    );
}

function Header({ user, theme, onThemeChange }) {
    return (
        <header>
            <h1>My App</h1>
            {user ? <span>ì•ˆë…•í•˜ì„¸ìš”, {user.name}ë‹˜!</span> : <span>ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</span>}
            <button onClick={() => onThemeChange(theme === 'light' ? 'dark' : 'light')}>
                {theme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸'} í…Œë§ˆ ë³€ê²½
            </button>
        </header>
    );
}
```

---

## keyë¥¼ ì‚¬ìš©í•œ ìƒíƒœ ì´ˆê¸°í™”

ë™ì¼í•œ ì»´í¬ë„ŒíŠ¸ì—ì„œ ìƒíƒœë¥¼ ì™„ì „íˆ ì´ˆê¸°í™”í•˜ê³  ì‹¶ì„ ë•Œ `key` propì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.

```jsx
function UserProfile({ userId }) {
    const [user, setUser] = useState(null);
    const [isLoading, setIsLoading] = useState(true);

    useEffect(() => {
        setIsLoading(true);
        fetchUser(userId).then((userData) => {
            setUser(userData);
            setIsLoading(false);
        });
    }, [userId]);

    if (isLoading) return <div>ë¡œë”© ì¤‘...</div>;

    return <div>ì‚¬ìš©ì: {user?.name}</div>;
}

// ì‚¬ìš©í•˜ëŠ” ê³³ì—ì„œ
function App() {
    const [currentUserId, setCurrentUserId] = useState(1);

    return (
        <div>
            {/* keyê°€ ë³€ê²½ë˜ë©´ ì»´í¬ë„ŒíŠ¸ê°€ ì™„ì „íˆ ìƒˆë¡œ ë§ˆìš´íŠ¸ë¨ */}
            <UserProfile key={currentUserId} userId={currentUserId} />
            <button onClick={() => setCurrentUserId((prev) => prev + 1)}>ë‹¤ìŒ ì‚¬ìš©ì</button>
        </div>
    );
}
```

---

## ì„±ëŠ¥ ìµœì í™” íŒ

### 1. ì§€ì—° ì´ˆê¸°í™” ì‚¬ìš©

```jsx
// âŒ ë§¤ë²ˆ ë³µì¡í•œ ê³„ì‚° ì‹¤í–‰
const [state, setState] = useState(expensiveCalculation());

// âœ… ì´ˆê¸° ë Œë”ë§ì—ì„œë§Œ ì‹¤í–‰
const [state, setState] = useState(expensiveCalculation);
```

### 2. ê°ì²´/ë°°ì—´ ì°¸ì¡° ìµœì í™”

```jsx
// âŒ ë§¤ë²ˆ ìƒˆ ê°ì²´ ìƒì„±ìœ¼ë¡œ ì¸í•œ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§
const [config, setConfig] = useState({});

const updateTheme = (newTheme) => {
    // ğŸš¨ ë¬¸ì œ: ê°’ì´ ê°™ì•„ë„ í•­ìƒ ìƒˆ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ setState í˜¸ì¶œ
    setConfig((prev) => ({
        ...prev,
        theme: newTheme,
    }));
};
```

-   `newTheme`ì´ ê¸°ì¡´ê°’ê³¼ ê°™ì€ì§€ í™•ì¸ì„ ì•ˆí•˜ê³  ìƒˆ ê°ì²´ë¥¼ ìƒì„±í•´ì„œ `setState`ë¥¼ í˜¸ì¶œí•œë‹¤.
-   ìƒˆ ê°ì²´ë¥¼ ìƒì„±í–ˆê¸° ë•Œë¬¸ì— ì°¸ì¡°ê°€ ë‹¬ë¼ì¡Œê³  ë¦¬ë Œë”ë§ì´ ë°œìƒí•œë‹¤.

```jsx
// âœ… ì‹¤ì œ ë³€ê²½ì´ ìˆì„ ë•Œë§Œ ìƒˆ ê°ì²´ ìƒì„±
const updateConfig = useCallback((key, value) => {
    setConfig((prev) => {
        if (prev[key] === value) return prev; // ê°™ì€ ê°’ì´ë©´ ì—…ë°ì´íŠ¸ í•˜ì§€ ì•ŠìŒ
        return { ...prev, [key]: value };
    });
}, []);
```

-   ê°’ì´ ê°™ìœ¼ë©´ ê¸°ì¡´ ê°ì²´ë¥¼ ê·¸ëŒ€ë¡œ ë°˜í™˜í•œë‹¤.

> ì‚¬ìš©ìê°€ ê°™ì€ ë²„íŠ¼ì„ ì—¬ëŸ¬ ë²ˆ í´ë¦­í•  ìˆ˜ ìˆëŠ” ìƒí™©, ë³µì¡í•œ ê°ì²´ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ìƒí™©ì—ì„œ ìœ„ì™€ ê°™ì€ `if`ë¶„ê¸°ë¥¼ í†µí•´ ë¦¬ë Œë”ë§ì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.
